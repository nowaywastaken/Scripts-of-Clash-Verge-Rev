function isDailyNode(name) {
    const include = /(ç¾Žå›½|æ—¥æœ¬|US|JP|Japan|America)/i.test(name);
    const exclude = /(é¦™æ¸¯|å°æ¹¾|HK|TW|HongKong|Taiwan)/i.test(name);
    return include && !exclude;
}

function isStreamNode(name) {
    return /(æ–°åŠ å¡|SG|Singapore)/i.test(name);
}

function isOvercooked(name) {
  return /(é¦™æ¸¯|HK|HongKong)/i.test(name);
}

function main(config) {

  const myRules = [
    // --- æµåª’ä½“é˜Ÿ (æ–°åŠ å¡) ---
    "DOMAIN-SUFFIX,netflix.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,netflix.net,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflximg.net,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxvideo.net,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxso.net,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxext.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-KEYWORD,netflix,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,fast.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    
    "DOMAIN-SUFFIX,tiktok.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,tiktokv.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,tiktokcdn.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-KEYWORD,tiktok,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,musical.ly,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,muscdn.com,ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    
    // --- æ—¥å¸¸ä¸»åŠ›é˜Ÿ (ç¾Ž/æ—¥) ---
    // Apple Relay
    "DOMAIN-SUFFIX,apple-relay.akamaized.net,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.apple.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.cloudflare.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.fastly-edge.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.mask.apple-dns.net,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,v2ex.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // Google
    "DOMAIN-KEYWORD,google,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,googleapis.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gstatic.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,youtu.be,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,ytimg.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // LINE
    "DOMAIN-SUFFIX,line.naver.jp,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line.me,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-apps.com,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-cdn.net,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-scdn.net,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // Porn Websites
    "DOMAIN-KEYWORD,pornhub,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-KEYWORD,xhamster,ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // Steam
    "DOMAIN-SUFFIX,steampowered.com,ðŸ‡­ðŸ‡° é¦™æ¸¯",

    //OverCooked
    "DOMAIN-SUFFIX,gameanalytics.com,ðŸ‡­ðŸ‡° é¦™æ¸¯",
    "DOMAIN-SUFFIX,t17service.com,ðŸ‡­ðŸ‡° é¦™æ¸¯",
    "DOMAIN-SUFFIX,964nzttlu1.execute-api.eu-west-1.amazonaws.com,ðŸ‡­ðŸ‡° é¦™æ¸¯",
    "IP-CIDR,59.37.139.7/32,ðŸ‡­ðŸ‡° é¦™æ¸¯,no-resolve",

    // --- ç›´è¿žè§„åˆ™ (ä¸ç”¨ç¿»å¢™) ---
    // è™½ç„¶DNSåœ¨å›½å¤–ï¼Œä½†IPå¦‚æžœåŒ¹é…åˆ°æ˜¯å±€åŸŸç½‘ï¼Œè¿˜æ˜¯ç›´è¿ž
    "IP-CIDR,172.16.0.0/12,DIRECT,no-resolve",
    "IP-CIDR,192.168.0.0/16,DIRECT,no-resolve",
    "IP-CIDR,192.192.0.0/32,DIRECT,no-resolve",
    "IP-CIDR,127.0.0.0/8,DIRECT,no-resolve",
    "IP-CIDR,10.0.0.0/8,DIRECT,no-resolve", 
];

  const proxies = config.proxies || [];
  const dailyProxies = proxies.filter(p => isDailyNode(p.name)).map(p => p.name);
  const streamProxies = proxies.filter(p => isStreamNode(p.name)).map(p => p.name);
  const overcookedProxies = proxies.filter(p => isOvercooked(p.name)).map(p => p.name);

  const groupDaily = {
    name: "ðŸ‡ºðŸ‡¸ðŸ‡¯ðŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    type: "url-test",
    url: "http://www.gstatic.com/generate_204",
    interval: 300,
    tolerance: 50,
    proxies: dailyProxies.length > 0 ? dailyProxies : ["DIRECT"]
  };

  const groupStream = {
    name: "ðŸ‡¸ðŸ‡¬ æµåª’ä½“",
    type: "url-test",
    url: "http://www.gstatic.com/generate_204",
    interval: 300,
    tolerance: 50,
    proxies: streamProxies.length > 0 ? streamProxies : ["DIRECT"]
  };

  const groupOvercooked = {
    name: "ðŸ‡­ðŸ‡° é¦™æ¸¯",
    type: "url-test",
    url: "http://www.gstatic.com/generate_204",
    interval: 300,
    tolerance: 50,
    proxies: overcookedProxies.length > 0 ? overcookedProxies : ["DIRECT"]
  };

  if (!config["proxy-groups"]) config["proxy-groups"] = [];
  config["proxy-groups"].unshift(groupDaily, groupStream, groupOvercooked);

  config.rules = myRules.concat(config.rules || []);

  return config;
}
