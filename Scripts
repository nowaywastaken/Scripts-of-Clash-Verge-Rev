// ==========================================
// 1. ç­›é€‰èŠ‚ç‚¹çš„é€»è¾‘ (æŒ‘é€‰é˜Ÿå‘˜ - ä¿æŒä¸å˜)
// ==========================================

// åˆ¤æ–­æ˜¯å¦ä¸º "æ—¥å¸¸èŠ‚ç‚¹" (ç¾å›½ æˆ– æ—¥æœ¬) ä¸” (ç»ä¸è¦ é¦™æ¸¯ å’Œ å°æ¹¾)
function isDailyNode(name) {
    const include = /(ç¾å›½|æ—¥æœ¬|US|JP|Japan|America)/i.test(name);
    const exclude = /(é¦™æ¸¯|å°æ¹¾|HK|TW|HongKong|Taiwan)/i.test(name);
    return include && !exclude;
}

// åˆ¤æ–­æ˜¯å¦ä¸º "æµåª’ä½“èŠ‚ç‚¹" (æ–°åŠ å¡)
function isStreamNode(name) {
    return /(æ–°åŠ å¡|SG|Singapore)/i.test(name);
}

// ==========================================
// 2. ä¸»ç¨‹åºå…¥å£
// ==========================================
function main(config) {
  
  // ------------------------------------------
  // ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å¥½ä½ çš„é«˜çº§ DNS (æ–°ç”µè¯æœ¬)
  // ------------------------------------------
  
  // å›½å†…DNSæœåŠ¡å™¨
  const domesticNameservers = [
    "https://dns.alidns.com/dns-query", // é˜¿é‡Œäº‘å…¬å…±DNS
    "https://doh.pub/dns-query", // è…¾è®¯DNSPod
    "https://doh.360.cn/dns-query" // 360å®‰å…¨DNS
  ];
  
  // å›½å¤–DNSæœåŠ¡å™¨
  const foreignNameservers = [
    "https://1.1.1.1/dns-query", // Cloudflare(ä¸»)
    "https://1.0.0.1/dns-query", // Cloudflare(å¤‡)
    "https://101.101.101.101/dns-query", // OpenDNS(ä¸»)
    "https://101.102.103.104/dns-query", // OpenDNS(å¤‡)
    "https://194.242.2.2/dns-query", // Mullvad(ä¸»)
    "https://194.242.2.3/dns-query" // Mullvad(å¤‡)
  ];

  // DNSé…ç½®ä¸»ä½“
  const myDnsConfig = {
    "enable": true,
    "listen": "0.0.0.0:1053",
    "ipv6": true, // ä½ æ–°é…ç½®é‡Œå¼€å¯äº†IPv6
    "use-system-hosts": false,
    "cache-algorithm": "arc",
    "enhanced-mode": "fake-ip",
    "fake-ip-range": "198.18.0.1/16",
    "fake-ip-filter": [
      "+.lan",
      "+.local",
      "+.msftconnecttest.com",
      "+.msftncsi.com",
      "localhost.ptlogin2.qq.com",
      "localhost.sec.qq.com",
      "localhost.work.weixin.qq.com"
    ],
    "default-nameserver": ["223.5.5.5", "119.29.29.29"],
    "nameserver": [...domesticNameservers, ...foreignNameservers],
    "proxy-server-nameserver": [...domesticNameservers, ...foreignNameservers],
    "nameserver-policy": {
      "geosite:private,cn,geolocation-cn": domesticNameservers,
      "geosite:google,youtube,telegram,gfw,geolocation-!cn": foreignNameservers,
    }
  };

  // ------------------------------------------
  // ç¬¬äºŒæ­¥ï¼šå‡†å¤‡åˆ†æµè§„åˆ™ (è´´è·¯æ ‡)
  // ------------------------------------------
  const myRules = [
    // --- æµåª’ä½“é˜Ÿ (æ–°åŠ å¡) ---
    // Netflix (è¿™ä¸€æ®µæ”¾åœ¨å‰é¢ï¼Œä¼˜å…ˆçº§æœ€é«˜)
    "DOMAIN-SUFFIX,netflix.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,netflix.net,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflximg.net,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxvideo.net,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxso.net,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,nflxext.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-KEYWORD,netflix,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,fast.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“", // æŠŠåŸæœ¬æ¼åœ¨ä¸‹é¢çš„æµ‹é€Ÿç½‘ä¹ŸåŠ ä¸Š
    
    // TikTok (è¿™ä¸€æ®µæ”¾åœ¨å‰é¢ï¼Œä¼˜å…ˆçº§æœ€é«˜)
    "DOMAIN-SUFFIX,tiktok.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,tiktokv.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,tiktokcdn.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-KEYWORD,tiktok,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,musical.ly,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    "DOMAIN-SUFFIX,muscdn.com,ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    
    // --- å‰©ä¸‹çš„å…¨éƒ¨ç»™æ—¥å¸¸ä¸»åŠ›é˜Ÿ (ç¾/æ—¥) ---
    // Apple Relay (éšç§ä¸­ç»§ç›¸å…³)
    "DOMAIN-SUFFIX,apple-relay.akamaized.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.apple.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.cloudflare.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.fastly-edge.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,apple-relay.mask.apple-dns.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,v2ex.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // ChatGPT
    "DOMAIN,api.statsig.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,browser-intake-datadoghq.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,chat.openai.com.cdn.cloudflare.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,o33249.ingest.sentry.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,openai-api.arkoselabs.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,openaicom-api-bdcpf8c6d2e9atf6.z01.azurefd.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,openaicomproductionae4b.blob.core.windows.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,production-openaicom-storage.azureedge.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN,static.cloudflareinsights.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-KEYWORD,openaicom-api,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,algolia.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,auth0.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,cdn.cloudflare.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,challenges.cloudflare.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chatgpt.livekit.cloud,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,client-api.arkoselabs.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,events.statsigapi.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,featuregates.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,host.livekit.cloud,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,identrust.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,intercom.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,intercomcdn.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,launchdarkly.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,oaistatic.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,oaiusercontent.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,observeit.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,openai.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,openaiapi-site.azureedge.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,openaicom.imgix.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,poe.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,segment.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,sentry.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,stripe.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,turn.livekit.cloud,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chatgpt.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "IP-CIDR,24.199.123.28/32,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›,no-resolve",
    "IP-CIDR,45.76.214.191/32,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›,no-resolve",
    "IP-CIDR,64.23.132.171/32,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›,no-resolve",
    "IP-CIDR,143.198.200.27/32,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›,no-resolve",
    "IP-CIDR,159.89.204.203/32,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›,no-resolve",

    // Google
    "DOMAIN-KEYWORD,blogspot,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-KEYWORD,google,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,abc.xyz,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,admin.recaptcha.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,ampproject.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,android.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,androidify.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,appspot.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,autodraw.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,blogger.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,capitalg.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,certificate-transparency.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chrome.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chromeexperiments.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chromestatus.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,chromium.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,creativelab5.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,debug.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,deepmind.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,dialogflow.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,firebaseio.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,getmdl.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,getoutline.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,ggpht.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gmail.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gmodules.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,godoc.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,golang.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gstatic.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gv.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gvt0.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gvt1.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gvt3.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,gwtproject.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,itasoftware.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,madewithcode.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,material.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,polymer-project.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,recaptcha.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,shattered.io,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,synergyse.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,telephony.goog,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,tensorflow.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,tfhub.dev,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,tiltbrush.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,waveprotocol.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,waymo.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,webmproject.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,webrtc.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,whatbrowser.org,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,widevine.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,x.company,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,xn--ngstr-lra8j.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,youtu.be,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,yt.be,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,ytimg.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // LINE
    "DOMAIN-SUFFIX,scdn.co,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line.naver.jp,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line.me,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-apps.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-cdn.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-SUFFIX,line-scdn.net,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // Porn Websites (å’³å’³ï¼Œå­¦ä¹ èµ„æ–™)
    "DOMAIN-KEYWORD,pornhub,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    "DOMAIN-KEYWORD,xhamster,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // Steam
    "DOMAIN-SUFFIX,steampowered.com,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // æ³¨æ„ï¼šMATCHè§„åˆ™æ”¾åœ¨æœ€åï¼Œä»£è¡¨â€œæ‰€æœ‰å‰é¢æ²¡æåˆ°çš„ï¼Œéƒ½èµ°è¿™æ¡è·¯â€
    "MATCH,ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",

    // --- ç›´è¿è§„åˆ™ (ä¸ç”¨ç¿»å¢™) ---
    "IP-CIDR,172.172.0.0/32,DIRECT,no-resolve",
    "IP-CIDR,192.168.0.0/32,DIRECT,no-resolve",
    "IP-CIDR,192.192.0.0/32,DIRECT,no-resolve",
    "IP-CIDR,127.0.0.0/32,DIRECT,no-resolve",
    "DOMAIN-KEYWORD,csust,DIRECT", // é•¿æ²™ç†å·¥
    "GEOIP,CN,DIRECT" // ä¸­å›½å¤§é™†ç›´è¿
];

  // ------------------------------------------
  // ç¬¬ä¸‰æ­¥ï¼šæå–èŠ‚ç‚¹å¹¶ç»„å»ºé˜Ÿä¼
  // ------------------------------------------
  const proxies = config.proxies || [];
  const dailyProxies = proxies.filter(p => isDailyNode(p.name)).map(p => p.name);
  const streamProxies = proxies.filter(p => isStreamNode(p.name)).map(p => p.name);

  // é˜Ÿä¼1: æ—¥å¸¸ä¸»åŠ›
  const groupDaily = {
    name: "ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ æ—¥å¸¸ä¸»åŠ›",
    type: "url-test",
    url: "http://www.gstatic.com/generate_204",
    interval: 300,
    tolerance: 50,
    proxies: dailyProxies.length > 0 ? dailyProxies : ["DIRECT"]
  };

  // é˜Ÿä¼2: æµåª’ä½“
  const groupStream = {
    name: "ğŸ‡¸ğŸ‡¬ æµåª’ä½“",
    type: "url-test",
    url: "http://www.gstatic.com/generate_204",
    interval: 300,
    tolerance: 50,
    proxies: streamProxies.length > 0 ? streamProxies : ["DIRECT"]
  };

  // æ’å…¥é˜Ÿä¼
  if (!config["proxy-groups"]) config["proxy-groups"] = [];
  config["proxy-groups"].unshift(groupDaily, groupStream);

  // ------------------------------------------
  // ç¬¬å››æ­¥ï¼šåº”ç”¨é…ç½®
  // ------------------------------------------
  
  // 1. è¦†ç›–è§„åˆ™
  config.rules = myRules.concat(config.rules || []);

  // 2. è¦†ç›– DNS (è¿™é‡Œç”¨äº†ä½ å‰é¢å®šä¹‰å¥½çš„ myDnsConfig)
  config["dns"] = myDnsConfig;

  return config;
}
